# **Pentesting Beginner Cheat Sheet**

## **nmap**

### **Scan Types**

* **-sT** - TCP Connect Scans
* **-sS** - SYN "Half-open" Scans
* **-sU**- UDP Scans

* **-sN** - TCP Null Scans
* **-sF** - TCP FIN Scans
* **-sX** - TCP Xmas Scans

See [here](https://upadhyayraj.medium.com/nmap-xmas-scan-idle-scan-fin-scan-null-scan-b95a5c73bef6#:~:text=So%20in%20Null%20Scan%20if,an%20RST%20packet%20in%20response) for more info. 

### **SYN Scan**

* **Open** = Received SYN/ACK.
* **Filtered / Closed** = Target responds with TCP RST.

**Note:** _SYN scans send back a RST (SYN, SYN/ACK, RST), but require sudo permissions in order to work correctly in Linux. This is because SYN scans require the ability to create raw packets (as opposed to the full TCP handshake), which is a privilege only the root user has by default._

### **UDP Scan**

* **Open** = No Response
* **Closed** = ICMP (ping) packet containing a message that the port is unreachable.
* **Filtered** = No response, or ICMP Packet.

**Note:** _UDP scans tend to be incredibly slow in comparison to the various TCP scans (in the region of 20 minutes to scan the first 1000 ports, with a good connection). Therefore, run Nmap scan with_ `--top-ports <number>` e.g.

```shell
nmap -sU --top-ports 20 <target>
```

will scan the top 20 most commonly used UDP ports, resulting in a much more acceptable scan time.

* When scanning UDP ports, Nmap usually sends completely empty requests -- just raw UDP packets.
  
* For ports which are usually occupied by well-known services, it sends a protocol-specific payload - more likely to elicit a response for a more accurate result.

### **NULL Scan**

* TCP request is sent with no flags set at all.
  
* **Open** = No Response.
* **Closed** = Target responds with RST.
* **Filtered** = No response, or ICMP Packet.

NULL scans are flagged by almost all intrusion prevention or intrusion detection systems.

### **FIN Scan**

* Request is sent with the FIN flag (usually used to gracefully close an active connection). 

* **Open** = No Response
* **Closed** = RST
* **Filtered** = No response, or ICMP Packet.

### **Xmas Scan**

* Sets the FIN, PSH, and URG flags, lighting the packet up like a Christmas tree.
* **Open / Filtered** = No Response
* **Closed** = RST
* **Filtered** = No response, or ICMP Packet.

* **Advantage**: can sneak through non-stateful firewalls and packet filtering routers.
  * These firewalls try to prevent incoming TCP connections by blocking any TCP packets with the SYN bit = 1, and ACK = 0.
  * Linux iptables firewall command offers a special --syn option to implement it.
  * Xmas scans set SYN bit = 0, therefore bypassing the rules. 

### ICMP Network Scanning

* `-sn` = Ping Sweep
  * If sudo, then this will perform ARP requests on a local network.

### If ICMP is blocked

* `-Pn` - NMap does not ping the host before scanning it - takes longer but bypasses ICMP blocked.
* 


### NSE (Nmap Scripting Engine)

* Written in Lua
* Categories:
  * safe:- Won't affect the target
intrusive:- Not safe: likely to affect the target
vuln:- Scan for vulnerabilities
exploit:- Attempt to exploit a vulnerability
auth:- Attempt to bypass authentication for running services (e.g. Log into an FTP server anonymously)
brute:- Attempt to bruteforce credentials for running services
discovery:- Attempt to query running services for further information about the network (e.g. query an SNMP server).

Scripts saved in /usr/share/nmap/scripts

Search Scripts: grep " " /usr/share/nmap/scripts/script.db




### Discovery + Information Gathering

```shell
ping
traceroute
whois
# Manually query recursive DNS servers of our choice for domain information
dig


```

if [ -f ~/.bash_aliases ]; then
    . ~/.bash_aliases
fi

/home/kali/labs/OpenVPN-Config-Files/thm.ovpn

/home/kali/labs/tryhackme

Bash Script for "First Start-Up for a Kali VM"

